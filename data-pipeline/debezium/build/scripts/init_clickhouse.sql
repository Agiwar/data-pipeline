CREATE DATABASE IF NOT EXISTS ods;

USE ods;

CREATE TABLE IF NOT EXISTS auth_pay_setting_history_tab (
    id                        Int64,
    auth_pay_id               Int64,
    history_type              Int32,
    update_time               DateTime64(6),
    channel_type              Int32,
    channel                   Nullable(String) DEFAULT NULL,
    channel_paytool_code      Nullable(String) DEFAULT NULL,
    channel_display_meta      Nullable(String) DEFAULT NULL,
    channel_display_detail    Nullable(String) DEFAULT NULL,
    use_jko_coin              Int16,
    single_payment_max_amount Nullable(decimal(20,2)) DEFAULT NULL,
    currency                  String DEFAULT 'TWD',
    create_time               DateTime64(6),
    modify_time               Nullable(DateTime64(6)) DEFAULT NULL,
    _version                  DateTime64(3) MATERIALIZED now64()
) ENGINE = ReplacingMergeTree(_version)
ORDER BY id;

CREATE TABLE IF NOT EXISTS PurchaseMain (
	ID                Int64,
	PurchaseNo        Nullable(String),
	PurchaseType      Int32,
	PayType           Int32,
	BaseAmount        Nullable(decimal(18, 2)),
	TotalAmount       decimal(18, 2),
	NoneDiscount      Nullable(decimal(18, 2)),
	PayAmount         decimal(18, 2),
	PurchaseStatus    Int32,
	PayCode           Nullable(String),
	CoinRate          Nullable(Int32),
	Redeem            Nullable(Int32),
	BenefitRedeem     Int32,
	PayBack           decimal(18, 2),
	StandingPayBack   Nullable(decimal(18, 2)),
	BenefitPayBack    decimal(18, 2),
	CashBackAmount    decimal(18, 2),
	UnRedeem          decimal(18, 2),
	PayRate           Nullable(decimal(18, 2)),
	FeeRate           Nullable(decimal(18, 2)),
	MealRate          Nullable(decimal(18, 2)),
	EventRedeemRate   Nullable(decimal(18, 2)),
	JKOSCoinRate      Nullable(decimal(18, 2)),
	DeliveryRate      Nullable(decimal(18, 2)),
	CreateTime        DateTime64(3),
	StoreID           Nullable(Int64),
	ReimburseStatus   Int32,
	AccountID         Int64,
	JKOSID            Nullable(String),
	TargetTitle       String,
	MemberPhone       Nullable(String),
	PurchaseID        Nullable(Int64),
	RowVersion        Int64,
	EventRedeem       Nullable(Int32),
	EventID           Nullable(Int64),
	TeamNo            Nullable(String),
	PartnerType       Int32,
	PartnerKey        Nullable(String),
	DeliveryFee       Int32,
	PaybackPrefer     Nullable(Int32),
	PayAccount        Nullable(String),
	ReceiptAccount    Nullable(String),
	Currency          Int32,
	TransactionSeq    String,
	TransactionTime   DateTime64(3),
	ReimburseID       Nullable(Int64),
	RedeemReimburseID Nullable(Int64),
	IsSpecificPayment Bool,
	IsJKOSReimburse   Bool,
	ESunBankOrderNo   Nullable(String),
	ESunReceiveTime   Nullable(String),
	PaybackPercent    Nullable(Int32),
	PayRateType       Int32,
	PayingAmount      Nullable(decimal(18, 2)),
	DepositAmount     Nullable(decimal(18, 2)),
	UpdateTime        DateTime64(3),
	UnPayBack         decimal(18, 2),
	_version          DateTime64(3) MATERIALIZED now64()
) ENGINE = ReplacingMergeTree(_version)
ORDER BY ID;